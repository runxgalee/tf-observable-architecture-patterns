# Production Environment Configuration

# Project Configuration
project_id   = "your-gcp-project-id-prod"
region       = "asia-northeast1"
project_name = "events"

# Pub/Sub Configuration
topic_name                              = "events"
message_retention_duration              = "86400s"  # 24 hours
ack_deadline_seconds                    = 60
retry_minimum_backoff                   = "10s"
retry_maximum_backoff                   = "600s"
max_delivery_attempts                   = 5
subscription_message_retention_duration = "604800s"  # 7 days
enable_exactly_once_delivery            = true  # Enabled for production

# Cloud Run Configuration
container_image      = "gcr.io/your-project-prod/event-processor:v1.0.0"  # Use specific version tag
min_instances        = 1  # Always keep at least 1 instance running
max_instances        = 100
concurrency          = 80
cpu_limit            = "2"  # Higher CPU for production
memory_limit         = "1Gi"  # More memory for production
cpu_always_allocated = true  # Keep CPU allocated for faster response
startup_cpu_boost    = true
request_timeout      = 300
log_level            = "INFO"  # Less verbose for production
enable_health_check  = true
health_check_path    = "/health"

# Additional environment variables
additional_env_vars = {
  # "DATABASE_URL" = "postgresql://..."
  # Use Secret Manager for sensitive values in production:
  # "API_KEY" = "projects/PROJECT_ID/secrets/api-key/versions/latest"
}

# VPC Configuration
# Recommended: Use VPC for production to access private resources
vpc_connector_name = ""  # e.g., "projects/PROJECT_ID/locations/REGION/connectors/vpc-connector"
vpc_egress         = "PRIVATE_RANGES_ONLY"

# IAM Configuration
cloud_run_additional_roles = [
  # "roles/cloudsql.client",
  # "roles/secretmanager.secretAccessor",
]

# Monitoring Configuration
enable_monitoring                    = true
dlq_alert_threshold                  = 0  # Alert immediately on any DLQ message
error_rate_threshold                 = 5  # Stricter threshold for production
oldest_unacked_message_age_threshold = 300  # 5 minutes
enable_custom_metrics                = true

# Notification channels (REQUIRED for production)
# Create notification channels first:
# gcloud alpha monitoring channels create \
#   --display-name="Production Alerts" \
#   --type=email \
#   --channel-labels=email_address=alerts@example.com

notification_channels = [
  # "projects/your-project/notificationChannels/1234567890",
]
